{"version":"V2.0","versionNumber":"V2.3.5","type":"stickc-plus2","components":[{"name":"screen","type":"screen","layer":0,"screenId":"builtin","screenName":"","id":"__stickc-plus2_screen","createTime":1757878581793,"x":0,"y":0,"width":135,"height":240,"backgroundColor":"#000000","size":0,"isSelected":true},{"name":"title0","type":"title","layer":1,"screenId":"builtin","screenName":"","id":"nupb3o_vvcWmxxRC","createTime":1757878588893,"x":0,"y":0,"color":"#ffffff","backgroundColor":"#0000FF","text":"Title","textOffset":3,"font":"Widgets.FONTS.DejaVu18","isSelected":false},{"name":"label0","type":"label","layer":2,"screenId":"builtin","screenName":"","id":"pKiFkcadztN%jBDT","createTime":1757878616489,"x":56,"y":49,"color":"#ffffff","backgroundColor":"#222222","text":"label0","font":"Widgets.FONTS.DejaVu40","rotation":0,"isSelected":false}],"resources":[{"hardware":["hardware_button","hardware_pin_button","imu","speaker","ir","i2c"]},{"unit":["unit_rfid"]}],"units":[{"type":"unit_rfid","name":"rfid_0","portList":["A","PAHUB","Custom"],"portType":"A","userPort":[22,21],"id":"dMqldOm`HC%9S3dJ","createTime":1757884899534,"bus":"i2c0","pahubPortList":[0,1,2,3,4,5],"pahubPort":0,"initBlockId":"KV)RSr`Vh;~9;UABnKbh"}],"hats":[],"bases":[],"i2cs":[{"id":"i2c0","portType":"A","userPort":[22,21],"freq":"100000","blockId":"i|}wYIVV*`_PSVOqEHy#"}],"blockly":"<block type=\"basic_on_setup\" id=\"setup_block\" deletable=\"false\" x=\"-30\" y=\"-70\"><mutation isBegin=\"true\"></mutation><field name=\"UPDATEOP\">true</field><statement name=\"FUNC\"><block type=\"system_m5_begin\" id=\"K(=HnMmq*B:o?%vTT3c`\"><next><block type=\"i2c_init\" id=\"i|}wYIVV*`_PSVOqEHy#\"><field name=\"NAME\">0</field><field name=\"FREQ\">100000</field><value name=\"SCL\"><shadow type=\"math_number\" id=\"4)],lPZ9tHJU(jBduc`X\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">33</field></shadow></value><value name=\"SDA\"><shadow type=\"math_number\" id=\"02L19dYY0H]mG1yf];|B\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">32</field></shadow></value><next><block type=\"unit_rfid_init\" id=\"KV)RSr`Vh;~9;UABnKbh\"><field name=\"NAME\">rfid_0</field><next><block type=\"speaker_set_volume\" id=\"/EAty(^IyVAU5upgMsRp\"><value name=\"VOLUME\"><shadow type=\"math_slider\" id=\"8j427*XI9u86s,4n/fEq\"><mutation max=\"255\" min=\"0\" step=\"1\" precision=\"1\"></mutation><field name=\"NUM\">200</field></shadow></value></block></next></block></next></block></next></block></statement></block><block type=\"basic_on_loop\" id=\"loop_block\" deletable=\"false\" x=\"-30\" y=\"170\"><mutation isUpdate=\"true\"></mutation><field name=\"UPDATEOP\">true</field><statement name=\"FUNC\"><block type=\"system_m5_update\" id=\"8Wnp,KxAZhZ.dybSTpv$\"><next><block type=\"controls_ifelse\" id=\"{b#llfON/N^iO~K`!4Q(\"><value name=\"IF0\"><block type=\"unit_rfid_is_new_card_present\" id=\";03{`^mEaXc=h/=`DuwQ\"><field name=\"NAME\">rfid_0</field></block></value><statement name=\"DO0\"><block type=\"label_set_text\" id=\"h?EkR]RFu$m]:;k.{Q3:\"><field name=\"NAME\">label0</field><value name=\"TEXT\"><shadow type=\"text\" id=\"U(=q!;r6adM[dZ/^,f6q\"><field name=\"TEXT\">Label</field></shadow><block type=\"unit_rfid_read_card_uid\" id=\"tvS^ZMA3^6/quFs/_gqL\"><field name=\"NAME\">rfid_0</field></block></value><next><block type=\"label_set_font\" id=\"o^@:#~P{@s6}mNOd|hQW\"><field name=\"NAME\">label0</field><field name=\"FONT\">Widgets.FONTS.EFontCN24</field><next><block type=\"speaker_tone\" id=\"9BBQ5u!k/[ZTw`|S*z13\"><value name=\"FREQ\"><shadow type=\"math_number\" id=\"0aFkq_N(GWbvow1U8;ig\"><mutation max=\"Infinity\" min=\"0\" precision=\"0\"></mutation><field name=\"NUM\">2000</field></shadow></value><value name=\"MS\"><shadow type=\"math_number\" id=\"Vczn1D!UdTrhxPk#Wv@%\"><mutation max=\"Infinity\" min=\"0\" precision=\"0\"></mutation><field name=\"NUM\">50</field></shadow></value></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"label_set_text\" id=\"lI6i4Y}qv4AC`y|{Cyiw\"><field name=\"NAME\">label0</field><value name=\"TEXT\"><shadow type=\"text\" id=\"TkHXi{Vo2?%4E%x9yf|=\"><field name=\"TEXT\">NO TAG</field></shadow></value><next><block type=\"label_set_font\" id=\"vE3ooT((hrfXelELloK6\"><field name=\"NAME\">label0</field><field name=\"FONT\">Widgets.FONTS.DejaVu40</field></block></next></block></statement></block></next></block></statement></block>","screen":[{"simulationName":"Built-in","type":"builtin","width":135,"height":240,"scale":0.67,"screenName":"","blockId":"","screenColorType":0,"rotation":3,"id":"builtin","createTime":1757878581791}],"logicWhenNum":0,"pythonCode":"import requests\nimport json\nimport network\nimport time\nimport os, sys, io\nimport M5\nfrom M5 import *\nfrom hardware import I2C\nfrom hardware import Pin\nfrom unit import RFIDUnit\n\nFIREBASE_HOST = \"https://iot5-67324-default-rtdb.firebaseio.com/\"\nPATH = \"tags.json\"\nAUTH = \"AIzaSyB7HouRf_sozv3xKp4b7P2xr0TEuoDdPl0\"\n\nurl = \"{}{}?auth={}\".format(FIREBASE_HOST,PATH,AUTH)\n\ntitle0 = None\nlabel0 = None\ni2c0 = None\nrfid_0 = None\n\n\ndef setup():\n  global title0, label0, i2c0, rfid_0\n\n  M5.begin()\n  global wlan\n  wlan = network.WLAN(network.STA_IF)\n  wlan.active(True)\n  wlan.connect(\"yousef\", \"0549109995\")\n  while not wlan.isconnected():\n    time.sleep(0.5)\n  print(\"WiFi connected\")\n  Widgets.setRotation(3)\n  Widgets.fillScreen(0x000000)\n  title0 = Widgets.Title(\"Title\", 3, 0xffffff, 0x0000FF, Widgets.FONTS.DejaVu18)\n  label0 = Widgets.Label(\"label0\", 56, 49, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu40)\n\n  i2c0 = I2C(0, scl=Pin(33), sda=Pin(32), freq=100000)\n  rfid_0 = RFIDUnit(i2c0)\n  Speaker.setVolume(200)\n\n\ndef loop():\n  global title0, label0, i2c0, rfid_0\n  M5.update()\n  if rfid_0.is_new_card_present():\n    tag_uid = rfid_0.read_card_uid()\n    if tag_uid:\n      tag_uid_hex = ''.join('{:02x}'.format(x) for x in tag_uid)\n      data = {\"uid\": tag_uid_hex, \"status\": \"ok\"}\n      resp = requests.post(url, data = json.dumps(data))\n      print(\"POST:\", resp.text)\n      label0.setText(\"UID: \" + tag_uid_hex)\n      label0.setFont(Widgets.FONTS.DejaVu40)\n      Speaker.tone(4000, 150)\n    else:\n      label0.setText(str('NO UID'))\n      label0.setFont(Widgets.FONTS.DejaVu40)\n      Speaker.tone(4000, 150)\n  else:\n    label0.setText(str('NO TAG'))\n    label0.setFont(Widgets.FONTS.DejaVu40)\n\n\nif __name__ == '__main__':\n  try:\n    setup()\n    while True:\n      loop()\n  except (Exception, KeyboardInterrupt) as e:\n    try:\n      from utility import print_error_msg\n      print_error_msg(e)\n    except ImportError:\n      print(\"please update to latest firmware\")\n","customList":[]}